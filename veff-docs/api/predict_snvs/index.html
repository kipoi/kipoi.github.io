<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>predict_snvs - Kipoi-veff</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "predict_snvs";
    var mkdocs_page_input_path = "api/predict_snvs.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Kipoi-veff</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../overview/">Overview</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Using</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../using/">Functions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../variant_effect_pred/">Variant effect prediction</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../mutation_map/">Mutation maps</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Tutorials</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../tutorials/variant_effect_prediction_simple/">Simple</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../tutorials/variant_effect_prediction/">Advanced</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../tutorials/mutation_map/">Mutation map</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Api</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../score_variants/">score_variants</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">predict_snvs</a>
    <ul class="current">
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../scores/">Available scores</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../MutationMap/">MutationMap</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../MutationMapPlotter/">MutationMapPlotter</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../KipoiVCFParser/">KipoiVCFParser</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Kipoi-veff</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Api &raquo;</li>
        
      
    
    <li>predict_snvs</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="http://github.com/kipoi/kipoi-veff/edit/master/docs/api/predict_snvs.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="predict_snvs">predict_snvs</h1>
<pre><code class="python">predict_snvs(model, dataloader, vcf_fpath, batch_size, num_workers=0, dataloader_args=None, vcf_to_region=None, vcf_id_generator_fn=&lt;function default_vcf_id_gen at 0x7f65009666a8&gt;, evaluation_function=&lt;function analyse_model_preds at 0x7f6500963f28&gt;, evaluation_function_kwargs={'diff_types': {'logit': &lt;kipoi_veff.scores.Logit object at 0x7f650096c400&gt;}}, sync_pred_writer=None, use_dataloader_example_data=False, return_predictions=False, generated_seq_writer=None)
</code></pre>

<p>Predict the effect of SNVs</p>
<p>Prediction of effects of SNV based on a VCF. If desired the VCF can be stored with the predicted values as
annotation. For a detailed description of the requirements in the yaml files please take a look at
the core <code>kipoi</code> documentation on how to write a <code>dataloader.yaml</code> file or at the documentation of
<code>kipoi-veff</code> in the section: <code>overview/#model-and-dataloader-requirements</code>.</p>
<p>The <code>evaluation_function</code> is evaluated after the model predictions for reference and alternative allele were
performed. By default the <code>analyse_model_preds</code> function is used, which executes the functions defined in its
argument <code>diff_types</code> on the reference and alternative prediction of every sample. When using the default
<code>analyse_model_preds</code>, then <code>evaluation_function_kwargs</code> has to be set to <code>{'diff_types': &lt;dict&gt;}</code>, where <code>dict</code>
is a dictionary of scoring functions (subclasses of <code>kipoi_veff.scores.Score</code>) and the keys will be used to
annotate the VCF (and dataframe) returned by <code>predict_snvs</code>.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><strong>model</strong>: A kipoi model handle generated by e.g.: <code>kipoi.get_model()</code></li>
<li><strong>dataloader</strong>: Dataloader factory generated by e.g.: <code>kipoi.get_dataloader_factory()</code></li>
<li><strong>vcf_fpath</strong>: Path of the VCF defining the positions that shall be assessed. Only SNVs will be tested.</li>
<li><strong>batch_size</strong>: Prediction batch size used for calling the data loader. Each batch will be generated in 4
        mutated states yielding a system RAM consumption of &gt;= 4x batch size.</li>
<li><strong>num_workers</strong>: Number of parallel workers for loading the dataset.</li>
<li><strong>dataloader_args</strong>: arguments passed on to the dataloader for sequence generation, arguments
        mentioned in dataloader.yaml &gt; postprocessing &gt; variant_effects &gt; bed_input will be overwritten
        by the methods here.</li>
<li><strong>vcf_to_region</strong>: Callable that generates a region compatible with dataloader/model from a cyvcf2 record</li>
<li><strong>vcf_id_generator_fn</strong>: Callable that generates a unique ID from a cyvcf2 record</li>
<li><strong>evaluation_function</strong>: effect evaluation function. Default is <code>analyse_model_preds</code>, which will get
        arguments defined in <code>evaluation_function_kwargs</code></li>
<li><strong>evaluation_function_kwargs</strong>: kwargs passed on to <code>evaluation_function</code>.</li>
<li><strong>sync_pred_writer</strong>: Single writer or list of writer objects like instances of <code>VcfWriter</code>. This object
        will be called after effect prediction of a batch is done.</li>
<li><strong>use_dataloader_example_data</strong>: Fill out the missing dataloader arguments with the example values given in the
        dataloader.yaml.</li>
<li><strong>return_predictions</strong>: Return all variant effect predictions as a dictionary. Setting this to False will
        help maintain a low memory profile and is faster as it avoids concatenating batches after prediction.</li>
<li><strong>generated_seq_writer</strong>: Single writer or list of writer objects like instances of <code>SyncHdf5SeqWriter</code>.
        This object will be called after the DNA sequence sets have been generated. If this parameter is
        not None, no prediction will be performed and only DNA sequence will be written!! This is relevant
        if you want to use the <code>predict_snvs</code> to generate appropriate input DNA sequences for your model.</li>
</ul>
<p><strong>Returns</strong></p>
<p><code>dict</code>: containing a pandas DataFrame containing the calculated values
        for each model output (target) column VCF SNV line. If <code>return_predictions == False</code>, returns None.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../scores/" class="btn btn-neutral float-right" title="Available scores">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../score_variants/" class="btn btn-neutral" title="score_variants"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="http://github.com/kipoi/kipoi-veff/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../score_variants/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../scores/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
